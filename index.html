<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CPNS PRO - DIMAS MIFTAH</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;800&display=swap');
        body { font-family: 'Plus Jakarta Sans', sans-serif; background-color: #f8fafc; }
        .btn-hover:active { transform: scale(0.96); }
    </style>
</head>
<body class="min-h-screen flex flex-col p-4 pb-12">

    <div class="max-w-md mx-auto w-full flex-grow space-y-4">
        
        <div class="bg-indigo-700 p-6 rounded-[2.5rem] shadow-xl text-white flex justify-between items-center">
            <div>
                <h1 class="text-xl font-black italic tracking-tighter text-yellow-400">BANK SOAL CPNS</h1>
                <P> SEMANGAT !!! </P>
                <p id="status" class="text-[8px] font-bold opacity-80 uppercase tracking-widest mt-1">Sistem Online ✅</p>
            </div>
            <div class="bg-white/20 px-5 py-2 rounded-2xl backdrop-blur-md text-center border border-white/10">
                <p id="skor" class="text-2xl font-black leading-none">0</p>
                <p class="text-[8px] font-bold uppercase tracking-tighter mt-1">Poin</p>
            </div>
        </div>

        <div class="bg-white p-6 rounded-[2.2rem] shadow-sm border border-slate-100 space-y-4">
            <div>
                <label class="text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1">Kategori Ujian</label>
                <select id="sel-kat" onchange="cekKategori()" class="w-full p-4 mt-2 rounded-2xl bg-slate-50 font-bold text-xs outline-none border-none appearance-none">
                    <option value="TIU">SKD - TIU</option>
                    <option value="TWK">SKD - TWK</option>
                    <option value="TKP">SKD - TKP</option>
                    <option value="SKB">SKB - JURUSAN</option>
                </select>
            </div>

            <div id="box-jurusan" class="hidden animate-in fade-in duration-300">
                <label class="text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1 text-indigo-600">Pilih Jurusan Anda</label>
                <select id="sel-pend" class="w-full p-4 mt-2 rounded-2xl bg-indigo-50 font-bold text-xs outline-none border-none text-indigo-700">
                    <option value="">-- Pilih Pendidikan --</option>
                </select>
            </div>

            <button onclick="ambilSoal()" class="w-full bg-indigo-600 text-white font-black py-4 rounded-2xl shadow-lg btn-hover uppercase text-xs tracking-widest">
                Tampilkan Soal
            </button>
        </div>

        <div id="quiz-area" class="hidden bg-white p-6 rounded-[2.5rem] shadow-sm border border-slate-100 animate-in slide-in-from-bottom-4 duration-500">
            <p id="tanya" class="text-slate-800 font-bold leading-relaxed mb-6 text-md"></p>
            <div id="opsi-list" class="space-y-3"></div>

            <div id="bahas-box" class="hidden mt-8 p-6 bg-slate-900 rounded-[2rem] text-white">
                <div class="flex items-center space-x-2 mb-3 text-emerald-400">
                    <p id="kunci-text" class="font-black text-[10px] uppercase tracking-widest"></p>
                </div>
                <p id="bahas-text" class="text-slate-400 text-[11px] leading-relaxed italic mb-5"></p>
                <button onclick="ambilSoal()" class="w-full py-3 bg-white text-indigo-900 font-black rounded-xl text-[10px] uppercase">Soal Lainnya</button>
            </div>
        </div>
    </div>

    <footer class="mt-8 text-center space-y-1">
        <p class="text-slate-400 text-[10px] font-black uppercase tracking-[0.4em]">© DIMAS MIFTAH 2026</p>
        <p><a href="https://www.instagram.com/dimasmiftah_/" target="_blank">Kunjungi Instagram Kami</a>
<a href="https://www.tiktok.com/@dimasmiftah_" target="_blank">Kunjungi TikTok Kami</a></p>

    </footer>

    <script>
        // GANTI LINK DI BAWAH INI DENGAN LINK CSV ANDA
        const URL_CSV = "https://docs.google.com/spreadsheets/d/e/2PACX-1vR5MwULy0Z0r6wFGeklJg1wZ6WTGyX1mArVzu6Nx6UF6hLngy7PsGngdmHvzsAQOvCx2NQeIfxhnx1W/pub?output=csv"; 
        
        let db = [];
        let totalPoin = 0;

        async function muatData() {
            try {
                const res = await fetch(URL_CSV);
                const txt = await res.text();
                const baris = txt.split(/\r?\n/).slice(1);
                
                db = baris.map(r => {
                    // Split kolom dengan koma
                    const c = r.split(/[,](?=(?:(?:[^"]*"){2})*[^"]*$)/);
                    return {
                        kat: c[0]?.trim(),
                        pend: c[1]?.trim(),
                        form: c[2]?.trim(),
                        soal: c[3]?.trim(),
                        opsi: c[4]?.split(";"), // Split jawaban dengan titik koma
                        kunci: c[5]?.trim(),
                        bahas: c[6]?.trim()
                    };
                }).filter(x => x.soal);

                // Otomatis isi pilihan jurusan
                const list = [...new Set(db.filter(x => x.kat === "SKB").map(x => x.pend))];
                const sel = document.getElementById('sel-pend');
                list.forEach(p => { if(p) sel.innerHTML += `<option value="${p}">${p}</option>`; });
            } catch (e) { console.error("Database Gagal"); }
        }

        function cekKategori() {
            const kat = document.getElementById('sel-kat').value;
            const box = document.getElementById('box-jurusan');
            kat === "SKB" ? box.classList.remove('hidden') : box.classList.add('hidden');
        }

        function ambilSoal() {
            const kat = document.getElementById('sel-kat').value;
            const pend = document.getElementById('sel-pend').value;
            
            let filtered = db.filter(x => x.kat === kat);
            if(kat === "SKB" && pend) filtered = filtered.filter(x => x.pend === pend);

            if(filtered.length === 0) return alert("Soal tidak ditemukan!");

            const item = filtered[Math.floor(Math.random() * filtered.length)];
            document.getElementById('quiz-area').classList.remove('hidden');
            document.getElementById('bahas-box').classList.add('hidden');
            document.getElementById('tanya').innerText = item.soal;

            const box = document.getElementById('opsi-list');
            box.innerHTML = "";

            // Menampilkan semua pilihan jawaban
            item.opsi.forEach(o => {
                const b = document.createElement('button');
                b.className = "w-full text-left p-4 rounded-2xl border-2 border-slate-50 bg-slate-50 font-bold text-xs text-slate-600 transition active:scale-95";
                b.innerText = o.trim();
                b.onclick = () => {
                    document.querySelectorAll('#opsi-list button').forEach(btn => btn.disabled = true);
                    if(o.trim() === item.kunci.trim()) {
                        b.classList.add('bg-emerald-50', 'border-emerald-500', 'text-emerald-700');
                        totalPoin += 5;
                        document.getElementById('skor').innerText = totalPoin;
                    } else {
                        b.classList.add('bg-red-50', 'border-red-500', 'text-red-700');
                    }
                    document.getElementById('kunci-text').innerText = "Kunci: " + item.kunci;
                    document.getElementById('bahas-text').innerText = item.bahas;
                    document.getElementById('bahas-box').classList.remove('hidden');
                };
                box.appendChild(b);
            });
        }

        muatData();
    </script>
</body>
</html>
